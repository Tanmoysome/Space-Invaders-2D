<html>
<canvas width = "1080" height="800" id="MyCanvas"></canvas>
<script>
    var g_canvas            = document.getElementById("MyCanvas");
    var g_context           = g_canvas.getContext("2d");
    var g_FPS               = 30;
    var g_frames            = 0;
    var g_TimeInterval      = 1000/g_FPS;
    var g_leftDirection     = false;
    var g_rightDirection    = true;
    var g_rightElement      = 0;
    var g_leftElement       = 0;
    var g_Alien_X_Speed     = 0;
    var g_Alien_Y_Speed     = 0;
    var g_collision         = false;
    var g_speed             = 6;
    var g_bulletCount       = 25; 
    var g_score             = 0;
    var g_shoot             = false;
    var g_GameUI            = true;
    var g_playgame          = false;
    var g_home              = true;
    var g_Inst              = false;
    var g_ReturnHome        = false;
    var g_mouseX            = 0;
    var g_mouseY            = 0;
    var g_MainMenu          = new C_MainMenu();
    var g_alienbulletArray  = new Array();
    var g_bulletArray       = new Array();
    var g_SpaceshipbulletArray = new Array();
    var g_backgroundbullet  = new Array();
    
    var g_BitmapArray1      = [0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,1,1,0,1,1,1,0,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,0,0,0,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
    var g_BitmapArray2      = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,0,1,1,1,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
    var g_BitmapArray3      = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,1,1,0,1,1,0,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
    
    var g_BitmapArray4      = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,0,0,1,1,0,0,1,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
    
    var g_BitmapArray5      = [0,0,0,0,1,0,0,0,0,
 0,0,0,0,1,0,0,0,0,
 0,0,0,1,0,1,0,0,0,
 0,0,1,0,1,0,1,0,0,
 1,0,1,0,1,0,1,0,1,
 1,1,1,0,1,0,1,1,1,
 1,0,0,1,1,1,0,0,1]
    
    var g_animatealien1Array = [0,0,0,0,0,0,0,0,0,0,0,0,
 0,0,0,0,0,0,0,0,0,0,0,0,
 0,0,1,0,0,0,0,0,1,0,0,0,
 1,0,0,1,0,0,0,1,0,0,1,0,
 1,0,1,1,1,1,1,1,1,0,1,0,
 1,1,1,0,1,1,1,0,1,1,1,0,
 1,1,1,1,1,1,1,1,1,1,1,0,
 0,1,1,1,1,1,1,1,1,1,0,0,
 0,0,1,0,0,0,0,0,1,0,0,0,
 0,1,0,0,0,0,0,0,0,1,0,0,
 0,0,0,0,0,0,0,0,0,0,0,0,
 0,0,0,0,0,0,0,0,0,0,0,0]
        
        var g_animatealien2Array = [0,0,0,0,0,0,0,0,0,0,0,0,
 0,0,0,0,0,0,0,0,0,0,0,0,
 0,0,0,0,1,1,1,1,0,0,0,0,
 0,1,1,1,1,1,1,1,1,1,1,0,
 1,1,1,1,1,1,1,1,1,1,1,1,
 1,1,1,0,0,1,1,0,0,1,1,1,
 1,1,1,1,1,1,1,1,1,1,1,1,
 0,0,1,1,1,0,0,1,1,1,0,0,
 0,1,1,0,0,1,1,0,0,1,1,0,
 0,0,1,1,0,0,0,0,1,1,0,0,
 0,0,0,0,0,0,0,0,0,0,0,0,
 0,0,0,0,0,0,0,0,0,0,0,0]
        
        var g_animatealien3Array = [0,0,0,0,0,0,0,0,0,0,0,0,
 0,0,0,0,0,0,0,0,0,0,0,0,
 0,0,0,0,0,1,1,0,0,0,0,0,
 0,0,0,0,1,1,1,1,0,0,0,0,
 0,0,0,1,1,1,1,1,1,0,0,0,
 0,0,1,1,0,1,1,0,1,1,0,0,
 0,0,1,1,1,1,1,1,1,1,0,0,
 0,0,0,0,1,0,0,1,0,0,0,0,
 0,0,0,1,0,1,1,0,1,0,0,0,
 0,0,1,0,1,0,0,1,0,1,0,0,
 0,0,0,0,0,0,0,0,0,0,0,0,
 0,0,0,0,0,0,0,0,0,0,0,0]
    
    
   var g_bitmapbunker1      = [1,1,1,1,0,0,0,0,
							          1,1,1,1,0,0,0,0,
									  1,1,1,1,0,0,0,0,
									  1,1,1,1,0,0,0,0,
                                      1,1,1,1,0,0,0,0,
							          1,1,1,1,1,1,1,1,
                                      1,1,1,1,1,1,1,1,
                                      0,0,0,0,0,0,0,0];
    
    var g_bitmapbunker1_1     = [1,1,0,0,0,0,0,0,
							          0,1,0,1,0,0,0,0,
									  1,0,1,0,0,0,0,0,
									  0,1,1,0,0,0,0,0,
                                      0,0,0,1,0,0,0,0,
							          1,0,1,0,1,0,1,1,
                                      0,1,1,0,1,1,0,1,
                                      0,0,0,0,0,0,0,0];
    
    var g_bitmapbunker1_2     = [1,0,0,1,0,0,0,0,
							          0,0,1,0,0,1,0,0,
									  1,0,0,0,1,0,0,0,
									  0,0,1,0,0,0,0,0,
                                      0,0,0,1,0,0,0,0,
							          1,0,1,0,1,0,0,1,
                                      0,0,1,0,1,0,0,0,
                                      0,0,0,0,0,0,0,0];
    
    var g_bitmapbunker4     = [0,0,0,0,1,1,1,1,
							          0,0,0,0,1,1,1,1,
									  0,0,0,0,1,1,1,1,
									  0,0,0,0,1,1,1,1,
                                      0,0,0,0,1,1,1,1,
							          1,1,1,1,1,1,1,1,
                                      1,1,1,1,1,1,1,1,
                                      0,0,0,0,0,0,0,0];
    
    var g_bitmapbunker4_1     = [0,0,0,0,0,1,0,1,
							          0,0,0,0,0,1,1,0,
									  0,0,0,0,1,0,1,0,
									  0,0,0,0,0,1,0,1,
                                      0,0,0,0,1,0,1,1,
							          1,0,0,1,0,0,1,0,
                                      0,0,0,0,1,0,0,1,
                                      0,0,0,0,0,0,0,0];
    
    var g_bitmapbunker4_2     = [0,0,0,0,0,0,0,1,
							          0,0,0,1,0,0,0,0,
									  0,0,0,0,0,1,0,0,
									  0,0,0,0,0,0,0,1,
                                      0,0,0,0,0,0,1,1,
							          1,0,0,0,0,1,1,0,
                                      0,0,0,0,1,0,0,1,
                                      0,0,0,0,0,0,0,0];
    
    var g_bitmapbunker2     = [0,0,0,0,1,1,1,1,
							          0,0,0,1,1,1,1,1,
									  0,0,1,1,1,1,1,1,
									  0,1,1,1,1,0,0,0,
									  1,1,1,1,0,0,0,0,
									  1,1,1,1,0,0,0,0,
									  1,1,1,1,0,0,0,0,
									  1,1,1,1,0,0,0,0];
    
    var g_bitmapbunker2_1     = [0,0,0,0,0,1,0,1,
							          0,0,0,0,0,1,0,1,
									  0,0,0,0,0,0,0,1,
									  0,1,0,0,1,0,0,0,
									  1,0,1,0,0,0,0,0,
									  0,1,0,1,0,0,0,0,
									  1,0,0,1,0,0,0,0,
									  0,1,0,0,0,0,0,0];
    
    var g_bitmapbunker2_2     = [0,0,0,0,0,0,0,1,
							          0,0,0,1,0,0,0,1,
									  0,1,0,0,0,1,0,0,
									  0,1,0,1,0,1,0,0,
									  1,0,0,0,0,0,0,0,
									  1,0,1,0,0,0,0,0,
									  0,0,1,0,0,0,0,0,
									  0,1,0,0,0,0,0,0];
    
    var g_bitmapbunker3     = [1,1,1,1,0,0,0,0,
							          1,1,1,1,1,0,0,0,
									  1,1,1,1,1,1,0,0,
									  0,0,0,1,1,1,1,0,
									  0,0,0,0,1,1,1,1,
									  0,0,0,0,1,1,1,1,
									  0,0,0,0,1,1,1,1,
									  0,0,0,0,1,1,1,1];
    
    var g_bitmapbunker3_1     = [1,0,1,0,0,0,0,0,
							          1,0,1,0,1,0,0,0,
									  0,1,0,1,0,1,0,0,
									  0,0,0,0,0,1,0,0,
									  0,0,0,1,0,1,0,1,
									  0,0,0,0,1,0,1,0,
									  0,0,0,0,1,0,0,1,
									  0,0,0,1,0,1,0,0];
    
    var g_bitmapbunker3_2     = [1,0,0,0,0,0,0,0,
							          1,0,0,1,0,0,0,0,
									  1,0,0,0,0,1,0,0,
									  0,1,0,1,0,1,0,0,
									  0,0,0,0,1,0,0,1,
									  0,0,0,1,0,0,1,0,
									  0,0,0,0,1,0,0,1,
									  0,0,0,1,0,0,1,0];
    
    
    var g_alien1objects     = new Array();
    var g_alien2obejcts     = new Array();
    var g_alien2_1objects   = new Array();
    var g_alien3objects     = new Array();
    
    
    var g_Spaceship         = new C_Grid(g_BitmapArray4,500,0,8,16,16,"#0000FF");
    var g_tank              = new C_Grid(g_BitmapArray5,500,720,9,7,9,"#FFD700");
    
    var g_bunker1           = new C_bunker(100,600,g_bitmapbunker1,g_bitmapbunker1_1,g_bitmapbunker1_2);
    var g_bunker2           = new C_bunker(110,560,g_bitmapbunker2,g_bitmapbunker2_1,g_bitmapbunker2_2);
    var g_bunker3           = new C_bunker(170,560,g_bitmapbunker3,g_bitmapbunker3_1,g_bitmapbunker3_2);
    var g_bunker4           = new C_bunker(180,600,g_bitmapbunker4,g_bitmapbunker4_1,g_bitmapbunker4_2);
 
    /*var g_alien1            = new C_Grid(g_BitmapArray1,10,10,10,12,12);
    var g_alien2            = new C_Grid(g_BitmapArray2,10,120,10,12,12)
    g_alien1.m_init();
    g_alien2.m_init();*/
    
    /*function f_initBunker()
    {
        for(var i=0; i<5; i++)
        {
            g_bunkerArray[i]
        }
    }*/
    function C_Pixel(l_Xpos, l_Ypos, l_size, l_color)
    {
        this.xPos= l_Xpos;
        this.yPos = l_Ypos;
        this.size = l_size;
        this.color = l_color;

        this.m_draw = function m_draw(l_ctx)
        {
            l_ctx.fillStyle = this.color;
            //l_ctx.lineWidth   = 2;
            //l_ctx.fillStyle ="White";
            l_ctx.fillRect(this.xPos,this.yPos,this.size,this.size);
            
        }
        
    }
    
    function C_Grid(l_bitmapArray,l_x,l_y,l_size,l_rows,l_cols,l_color,l_bitmapArray2,l_bmap3)
    {
        this.x = l_x;
        this.y = l_y;
        this.size = l_size;
        this.rows = l_rows;
        this.cols = l_cols;
        this.color = l_color;
        this.moveright = false;
        this.moveleft  = false;
        this.bitmapArray = l_bitmapArray;
        this.bitmap2Array = l_bitmapArray2;
        this.PixelGrid = new Array(this.rows*this.cols);
        this.move      = true;
        this.alive     = false;
        this.speed     = 10;
        this.drawFlag  = 1;
        this.hitcount  = 0;
        this.lives     = 3;
        
        
        this.m_init = function m_init()
        {
            this.index = 0;
            
                for(var i=0;i<this.rows;i++)
                {
                    for(var j=0;j<this.cols;j++)
                    {
                        this.PixelGrid[this.index] = new C_Pixel(this.x,this.y,this.size,this.color)
                        this.alive = true;
                        this.x += this.size;
                        this.index++;
                    }
                    this.x = l_x;
                    this.y += this.size;
                }
        }
            
        this.m_drawGrid = function m_drawGrid(l_ctx)
        {
            if(this.drawFlag == 1)
            {
                if(this.alive)
                {
                    for(var i=0;i<this.PixelGrid.length; i++)
                    {
                        if(this.hitcount == 0)
                        {
                            if(this.bitmapArray[i] == 1)
                            {

                                this.PixelGrid[i].m_draw(l_ctx);
                            }
                        }

                        else if(this.hitcount == 1)
                        {
                            if(this.bitmap2Array[i] == 1)
                            {

                                this.PixelGrid[i].m_draw(l_ctx);
                            }
                        }

                        else if(this.hitcount == 2)
                        {
                            if(l_bmap3[i] == 1)
                            {

                                this.PixelGrid[i].m_draw(l_ctx);
                            }
                        }
                    }
                }
            }
            
            else
            {
                for(var i=0;i<this.PixelGrid.length; i++)
                {
                    if(this.bitmap2Array[i] == 1)
                    {
                        if(this.alive)
                        this.PixelGrid[i].m_draw(l_ctx);
                    }
                }
            }
            
        
                
            
            
        }
        
        this.m_moveSpaceShip = function m_moveSpaceShip()
        {
            for(var i=0; i<this.PixelGrid.length; i++)
            {
                this.PixelGrid[i].xPos += this.speed;
            }
                
        }
        
        this.m_movetank = function m_movetank()
        {
            this.speed = -5;
            for(var i=0; i<this.PixelGrid.length; i++)
            {
                if(this.moveleft)
                {
                    
                     this.PixelGrid[i].xPos += this.speed;
                }
                
                if(this.moveright)
                {
                    this.speed = 5
                    this.PixelGrid[i].xPos += this.speed;
                }
            }
        }
        
        this.m_moveAlien = function m_moveAlien(l_speedx,l_speedy)
        {
            this.count = 0;
            for(var i=0;i<this.rows;i++)
            {
                for(var j=0;j<this.cols;j++)
                {
                    this.PixelGrid[this.count].xPos += l_speedx;
                    this.PixelGrid[this.count].yPos += l_speedy;
                    this.count++;
                    
                }
            }
            
                        
        }
        
        this.m_boundarycollision = function m_boundarycollision()
        {
            for(var i=0;i<this.PixelGrid.length; i++)
            {
                if(this.PixelGrid[i].xPos >= 1080)
                {
                this.speed = -10;
                }
                
                if(this.PixelGrid[i].xPos+this.size <= 0)
                {
                this.speed = +10;
                }
            }
        }
    }
    
    function C_bunker(l_x,l_y,l_bunkerbitmaparray,l_bmap1,l_bmap2)
    {
        this.xpos = l_x;
        this.ypos = l_y;
        this.bitmapArray = l_bunkerbitmaparray;
        this.bunkerArray = new Array();
        this.alive       = true;
        
        this.m_initbunker = function m_initbunker()
        {
            for(var i=0; i<5; i++)
            {
                this.bunkerArray[i] = new C_Grid(this.bitmapArray,this.xpos,this.ypos,8,8,8,"Purple",l_bmap1,l_bmap2);
                this.bunkerArray[i].m_init();
                this.xpos += 200;
            }
        }
        
        this.m_drawbunker = function m_drawbunker(l_ctx)
        {
            for(var i=0;i<this.bunkerArray.length; i++)
            {
                if(this.alive)
                {this.bunkerArray[i].m_drawGrid(l_ctx);}
            }
        }
    }
    
    function C_Bullet(l_x, l_y, l_w, l_h)
    {
        this.x              = l_x;
        this.y              = l_y;
        this.initialXpos    = l_x;
        this.initialYpos    = l_y;
        this.w              = l_w;
        this.h              = l_h;
        this.speed          = 0;
        this.active         = false;
        this.frames         = 0;
        
        this.m_draw = function m_draw(l_ctx)
        {
            if(this.active)
            {
                if(this.speed>0)
                {
                    l_ctx.fillStyle = "white";
                    l_ctx.fillRect(this.x,this.y,this.w,-this.h);
                }
                
                else if(this.speed<0)
                {
                    l_ctx.fillStyle = "red";
                    l_ctx.fillRect(this.x,this.y,this.w,-this.h);
                }
                
            }
            
        }
        
        this.m_moveBullet = function m_moveBullet()
        {
            if(this.active)
            {this.y += this.speed;}
        }
        
        this.m_CheckBoundaryCollision = function m_CheckBoundaryCollision()
        {
            if(this.active)
            {
                if(this.y <= 0 || this.y >= 800)
                {
                     this.active   = 0;
                }
            }
        }
        
        this.m_spawn = function m_spawn(l_ctx)
        {
            
            //if(this.frames%15 == 0)
            {
                //this.y += 5;
                l_ctx.fillStyle = "white";
                l_ctx.fillRect(this.x,this.y,this.w,-this.h);
            }
            this.frames++;
        }
        
    }
    
    function f_Initbkbullets()
    {
        var l_x = 10;
        var l_y = 0;
        for(var i=0;i<30;i++)
        {
            g_backgroundbullet[i] = new C_Bullet(l_x,l_y,3,5);
            l_x += 10;
        }
    }
    
    function f_MoveBckg()
    {
        for(var i=0; i<g_backgroundbullet.length; i++)
        {
            g_backgroundbullet[i].m_spawn(g_context);
        }
    }
    
    function f_initbullet()
    {
        for(var i=0;i<g_bulletCount;i++)
        {
            g_bulletArray[i] = new C_Bullet(0,0,8,12);
            g_alienbulletArray[i] = new C_Bullet(0,1,8,12);
        }
    }
    
    function f_DrawBullets()
    {
        for(var i=0; i<g_bulletCount; i++)
        {
            g_bulletArray[i].m_draw(g_context);
            g_alienbulletArray[i].m_draw(g_context);
        }
    }
    
    function f_moveBullet()
    {
        for(var i=0;i<g_bulletCount; i++)
        {
            g_bulletArray[i].m_moveBullet();
            g_alienbulletArray[i].m_moveBullet();
        }
    }
    
    function f_CheckBulletBoundaryCollision()
    {
        for(var i=0 ; i<g_bulletCount; i++)
        {
            g_bulletArray[i].m_CheckBoundaryCollision();
            g_alienbulletArray[i].m_CheckBoundaryCollision();
        }
    }
    
    function f_FireBullet(l_x,l_y,l_speed)
    {
        for(var i=0 ; i<g_bulletCount; i++)
        {
            if(!g_bulletArray[i].active)
            {
                g_bulletArray[i].x = l_x;
                g_bulletArray[i].y = l_y;
                g_bulletArray[i].speed = l_speed;
                g_bulletArray[i].active = true;
                return;
            }
        }
    }
    
    function f_FireAlienBullet(l_x,l_y,l_speed)
    {
        for(var i=0 ; i<g_bulletCount; i++)
        {
            if(!g_alienbulletArray[i].active)
            {
                g_alienbulletArray[i].x = l_x;
                g_alienbulletArray[i].y = l_y;
                g_alienbulletArray[i].speed = l_speed;
                g_alienbulletArray[i].active = true;
                return;
            }
        }
    }
    
    
    function f_tankbullets()
    {
        if(g_frames%5 == 0)
        {
            if(g_tank.alive)
            {
                if(g_shoot)
                {
                    f_FireBullet(g_tank.PixelGrid[4].xPos+1,g_tank.PixelGrid[12].yPos+5,-8)
                }
            }
            
        }
        
    }
    
    function f_MotherShipBullets()
    {
        if(g_frames%60 == 0)
        {
            if(g_tank.alive)
            {
               if(g_Spaceship.alive)
                {
                    f_FireAlienBullet(g_Spaceship.PixelGrid[4].xPos+15,g_Spaceship.PixelGrid[4].yPos+90,8)
                } 
            }
            
        }
    }
    
    function f_AlienBullets()
    {
        var l_alien = new Array();
        if(g_tank.alive)
        {
            for(var k=0; k<1; k++)
            {
                l_alien[k] = parseInt(Math.random()*8);
            }
            for(var i=0;i<9;i++)
            {
                for(var k=0; k<2; k++)
                {
                    if(i==l_alien[k])
                    {
                        if(g_frames%30 == 0)  
                        {
                            if(g_alien3objects[i].alive)
                            {
                                f_FireAlienBullet(g_alien3objects[i].PixelGrid[100].xPos+5,g_alien3objects[i].PixelGrid[12].yPos+15,5)
                            }

                            else if(g_alien2_1objects[i].alive)
                            {
                                f_FireAlienBullet(g_alien2_1objects[i].PixelGrid[100].xPos+1,g_alien2_1objects[i].PixelGrid[12].yPos+5,5)
                            }

                            else if(g_alien2obejcts[i].alive)
                            {
                                f_FireAlienBullet(g_alien2obejcts[i].PixelGrid[100].xPos+1,g_alien2obejcts[i].PixelGrid[12].yPos+5,5)
                            }

                            else if(g_alien1objects[i].alive)
                            {
                                f_FireAlienBullet(g_alien1objects[i].PixelGrid[100].xPos+1,g_alien1objects[i].PixelGrid[12].yPos+5,5)
                            }
                        }
                    }
                }

            }
        }
        
    }
    
    function f_AlienObjects()
    {
        var l_x = 180;
        for(var i=0; i<9; i++)
        {
            g_alien1objects[i] = new C_Grid(g_BitmapArray1,l_x,94,4,12,12,"#00FF00",g_animatealien1Array);
            g_alien2obejcts[i] = new C_Grid(g_BitmapArray2,l_x,138,4,12,12,"#800000",g_animatealien2Array);
            g_alien2_1objects[i] = new C_Grid(g_BitmapArray2,l_x,190,4,12,12,"#800000",g_animatealien2Array);
            g_alien3objects[i] = new C_Grid(g_BitmapArray3,l_x-5,229,5,12,12,"#FF4500",g_animatealien3Array);
            g_alien1objects[i].m_init();
            g_alien2obejcts[i].m_init();
            g_alien2_1objects[i].m_init();
            g_alien3objects[i].m_init();
            
            l_x += 80
        }
        console.log(g_alien1objects[8]);
    }
    
    function f_drawAlienObjects()
    {
        for(var i=0; i<9; i++)
        {
            if(g_frames%12 == 0)
            {
                if(g_alien1objects[i].drawFlag == 1){g_alien1objects[i].drawFlag = 2}
                else if(g_alien1objects[i].drawFlag == 2){g_alien1objects[i].drawFlag = 1}
                
                if(g_alien2obejcts[i].drawFlag == 1){g_alien2obejcts[i].drawFlag = 2}
                else if(g_alien2obejcts[i].drawFlag == 2){g_alien2obejcts[i].drawFlag = 1}
                
                if(g_alien2_1objects[i].drawFlag == 1){g_alien2_1objects[i].drawFlag = 2}
                else if(g_alien2_1objects[i].drawFlag == 2){g_alien2_1objects[i].drawFlag = 1}
                
                if(g_alien3objects[i].drawFlag == 1){g_alien3objects[i].drawFlag = 2}
                else if(g_alien3objects[i].drawFlag == 2){g_alien3objects[i].drawFlag = 1}
            }

            g_alien1objects[i].m_drawGrid(g_context);
            g_alien2obejcts[i].m_drawGrid(g_context);
            g_alien2_1objects[i].m_drawGrid(g_context);
            g_alien3objects[i].m_drawGrid(g_context);
        }
       
    }

    function f_moveAliens()
    {
        g_frames++;
        if(g_tank.alive)
        {
           if(g_frames%12 == 0)
            {
                 if(g_collision)
                    {
                        console.log(g_Alien_Y_Speed);
                        g_Alien_Y_Speed = 15;
                        g_Alien_X_Speed = 0;
                        g_collision = false;
                    }
                else
                {
                    if(g_Alien_Y_Speed>0)
                        {
                            console.log(g_Alien_Y_Speed);
                            g_Alien_Y_Speed = 0;
                            g_Alien_X_Speed = -g_speed;
                            console.log(g_Alien_X_Speed);
                        }
                }

                for(var i=0; i<9; i++)
                {
                    g_alien1objects[i].m_moveAlien(g_Alien_X_Speed,g_Alien_Y_Speed);
                    g_alien2obejcts[i].m_moveAlien(g_Alien_X_Speed,g_Alien_Y_Speed);
                    g_alien2_1objects[i].m_moveAlien(g_Alien_X_Speed,g_Alien_Y_Speed);
                    g_alien3objects[i].m_moveAlien(g_Alien_X_Speed,g_Alien_Y_Speed);
                }
            } 
        }
        
    }
    
    function f_AlienBoundaryCollision()
    {
        if(g_frames%12 == 0)
        {
            if(g_leftDirection)
            {
                for(var i=0;i<9;i++)
                {
                    
                    if(g_alien1objects[i].alive)
                    {
                       
                        g_alien = i;
                        break;
                    }

                    if(g_alien2obejcts[i].alive)
                    {
                        g_alien = i;
                        break;
                    }

                    if(g_alien2_1objects[i].alive)
                    {
                        g_alien = i;
                        break;
                    }

                    if(g_alien3objects[i].alive)
                    {
                        g_alien = i;
                        break;
                    }
                    console.log(g_alien)
                }
            
                if((g_alien1objects[0].PixelGrid[0].xPos) <= 0)
                {
                    console.log("hit left")

                    g_collision = true;

                    for(var i=0; i<9; i++)
                    {
                        g_alien1objects[i].m_moveAlien(g_Alien_X_Speed,0);
                        g_alien2obejcts[i].m_moveAlien(g_Alien_X_Speed,0);
                        g_alien2_1objects[i].m_moveAlien(g_Alien_X_Speed,0);
                        g_alien3objects[i].m_moveAlien(g_Alien_X_Speed,0);
                    }  
                    g_rightDirection = true;
                    g_leftDirection = false;
                }
            }
        }
        
        if(g_rightDirection)
        {
            g_Alien_X_Speed = g_speed;
            
            for(var j=8;j>=0;j--)
            {
                if(g_alien1objects[j].alive)
                {
                    g_alien = j;
                    break;
                }
                
                if(g_alien2obejcts[j].alive)
                {
                    g_alien = j;
                    break;
                }
                
                if(g_alien2_1objects[j].alive)
                {
                    g_alien = j;
                    break;
                }
                
                if(g_alien3objects[j].alive)
                {
                    g_alien = j;
                    break;
                }
            }
            
            if((g_alien1objects[g_alien].PixelGrid[g_alien1objects[g_alien].cols-1].xPos + g_alien1objects[g_alien].size) >= 1070)
            {
                console.log("hit right")
                g_leftDirection = true;
                g_collision = true;

                for(var i=0; i<9; i++)
                {
                    g_alien1objects[i].m_moveAlien(-g_Alien_X_Speed,0);
                    g_alien2obejcts[i].m_moveAlien(-g_Alien_X_Speed,0);
                    g_alien2_1objects[i].m_moveAlien(-g_Alien_X_Speed,0);
                    g_alien3objects[i].m_moveAlien(-g_Alien_X_Speed,0);
                }


                g_rightDirection = false;
            }
        }    
    }
    
    function f_BulletCollisionwithAliens()
    {
        for(var i=0;i<g_bulletCount;i++)
        {
            if(g_bulletArray[i].active)
            {
                for(var j=0;j<9;j++)
                {
                    if(g_alien1objects[j].alive)
                    {
                        if(g_bulletArray[i].x >= g_alien1objects[j].PixelGrid[0].xPos && g_bulletArray[i].x <= g_alien1objects[j].PixelGrid[0].xPos+48)
                        {
                            if(g_bulletArray[i].y >= g_alien1objects[j].PixelGrid[0].yPos && g_bulletArray[i].y <= g_alien1objects[j].PixelGrid[0].yPos+48)
                            {
                                g_alien1objects[j].alive = false;
                                g_bulletArray[i].active =false;
                                g_score++;
                                console.log(g_score); 
                            }
                        }
                    }
                    if(g_alien2obejcts[j].alive)
                    {
                        if(g_bulletArray[i].x >= g_alien2obejcts[j].PixelGrid[0].xPos && g_bulletArray[i].x <= g_alien2obejcts[j].PixelGrid[0].xPos+48)
                        {
                            if(g_bulletArray[i].y >= g_alien2obejcts[j].PixelGrid[0].yPos && g_bulletArray[i].y <= g_alien2obejcts[j].PixelGrid[0].yPos+48)
                            {
                                g_alien2obejcts[j].alive = false;
                                g_bulletArray[i].active =false;
                                g_score++;
                                console.log(g_score);  
                            }
                        }
                    }
                    
                    if(g_alien2_1objects[j].alive)
                    {
                        if(g_bulletArray[i].x >= g_alien2_1objects[j].PixelGrid[0].xPos && g_bulletArray[i].x <= g_alien2_1objects[j].PixelGrid[0].xPos+48)
                        {
                            if(g_bulletArray[i].y >= g_alien2_1objects[j].PixelGrid[0].yPos && g_bulletArray[i].y <= g_alien2_1objects[j].PixelGrid[0].yPos+48)
                            {
                                g_alien2_1objects[j].alive = false;
                                g_bulletArray[i].active =false;
                                g_score++;
                                console.log(g_score); 
                            }
                        }
                    }
                    
                    if(g_alien3objects[j].alive)
                    {
                        if(g_bulletArray[i].x >= g_alien3objects[j].PixelGrid[0].xPos && g_bulletArray[i].x <= g_alien3objects[j].PixelGrid[0].xPos+48)
                        {
                            if(g_bulletArray[i].y >= g_alien3objects[j].PixelGrid[0].yPos && g_bulletArray[i].y <= g_alien3objects[j].PixelGrid[0].yPos+48)
                            {
                                g_alien3objects[j].alive = false;
                                g_bulletArray[i].active =false;
                                g_score++;
                                console.log(g_score);
                            }
                        }
                    }
                    
                }
                
            }
        }
    }
    
    function f_AlienBulletBunkerCollision(l_bunker)
    {
        for(var i=0; i<g_bulletCount; i++)
        {
            if(g_alienbulletArray[i].active)
            {
                for(var j=0; j<l_bunker.bunkerArray.length; j++)
                {
                    if(l_bunker.bunkerArray[j].alive)
                    {
                        if(g_alienbulletArray[i].x > l_bunker.bunkerArray[j].PixelGrid[0].xPos && 
                           g_alienbulletArray[i].x < l_bunker.bunkerArray[j].PixelGrid[15].xPos+8)
                        {
                            if(g_alienbulletArray[i].y > l_bunker.bunkerArray[j].PixelGrid[0].yPos && g_alienbulletArray[i].y < l_bunker.bunkerArray[j].PixelGrid[15].yPos+8)
                            {
                                console.log(">>"+j);
                                l_bunker.bunkerArray[j].hitcount++
                                if(l_bunker.bunkerArray[j].hitcount > 2)
                                {
                                    l_bunker.bunkerArray[j].alive = false;
                                }
                                g_alienbulletArray[i].active  = false;
                                break;
                            }
                        }
                    }
                    
                }
            }
        }
    }
    
    function f_TankBulletBunkerCollision(l_bunker)
    {
        for(var i=0; i<g_bulletCount; i++)
        {
            if(g_bulletArray[i].active)
            {
                for(var j=0; j<l_bunker.bunkerArray.length; j++)
                {
                    if(l_bunker.bunkerArray[j].alive)
                    {
                        if(g_bulletArray[i].x > l_bunker.bunkerArray[j].PixelGrid[0].xPos && 
                           g_bulletArray[i].x < l_bunker.bunkerArray[j].PixelGrid[15].xPos)
                        {
                            if(g_bulletArray[i].y > l_bunker.bunkerArray[j].PixelGrid[0].yPos && g_bulletArray[i].y < l_bunker.bunkerArray[j].PixelGrid[15].yPos)
                            {
                                l_bunker.bunkerArray[j].hitcount++
                                if(l_bunker.bunkerArray[j].hitcount > 2)
                                {
                                    l_bunker.bunkerArray[j].alive = false;
                                }
                                g_bulletArray[i].active  = false;
                                break;
                            }
                        }
                    }
                    
                }
            }
        }
    }
    
    function f_AlienBulletTankCollision()
    {
        for(var i=0; i<g_bulletCount; i++)
        {
            if(g_alienbulletArray[i].active)
            {
                if(g_tank.alive)
                {
                    if(g_alienbulletArray[i].x >= g_tank.PixelGrid[0].xPos && g_alienbulletArray[i].x <= g_tank.PixelGrid[0].xPos+128)
                    {
                        if(g_alienbulletArray[i].y >= g_tank.PixelGrid[0].yPos && g_alienbulletArray[i].y <= g_tank.PixelGrid[0].yPos+100)
                        {
                            g_tank.lives--;
                            if(g_tank.lives<=0)
                            {g_tank.alive = false;
                            g_shoot = false;}
                            g_alienbulletArray[i].active =false;
                            g_score -= 2;
                            console.log(g_tank.lives);
                        }
                    }
                }
            }
        }
    }
          
    function f_tankBoundaryCollision()
    {
        if(g_tank.moveleft)
        {
            if(g_tank.PixelGrid[0].xPos<=0)
            {
                g_tank.speed = 0;
            }
            
        }
        if(g_tank.moveright)
        {
            if(g_tank.PixelGrid[0].xPos+g_tank.size >= 1070)
            {
                g_tank.speed = 0;
            }
        }
            
        
    }
    
    function f_clearCanvas()
    {
        g_context.clearRect(0,0,g_canvas.width,g_canvas.height);
        g_context.fillStyle = "Black";
        g_context.fillRect(0,0,g_canvas.width,g_canvas.height);
    } 
    
    function f_BulletCollisionwithSpaceShip()
    {
        for(var i=0;i<g_bulletCount;i++)
        {
            if(g_bulletArray[i].active)
            {
                if(g_Spaceship.alive)
                {
                    if(g_bulletArray[i].x >= g_Spaceship.PixelGrid[0].xPos && g_bulletArray[i].x <= g_Spaceship.PixelGrid[0].xPos+128)
                    {
                        if(g_bulletArray[i].y >= g_Spaceship.PixelGrid[0].yPos && g_bulletArray[i].y <= g_Spaceship.PixelGrid[0].yPos+100)
                        {
                            g_Spaceship.alive = false;
                            g_bulletArray[i].active =false;
                            g_score += 5;
                            console.log(g_score);
                        }
                    }
                }
            }
        }
    }
    
    function f_KeyDownEventHandler(l_EventData)
    {
        if(l_EventData.keyCode == 37) 
         {g_tank.moveleft   = 1;
         }

        if(l_EventData.keyCode == 39) 
         {g_tank.moveright  = 1;
         }

        if(l_EventData.keyCode == 32)
         {g_shoot = true;}

    }

    function f_KeyUpEventHandler(l_EventData)
    {
        if(l_EventData.keyCode == 37) 
        {g_tank.moveleft    = 0;}  

        if(l_EventData.keyCode == 39) 
        {g_tank.moveright   = 0;}
        
        if(l_EventData.keyCode == 32)
         {g_shoot = false;}

    }
    
    function C_Button(l_x,l_y,l_w,l_h,l_type)
    {
        this.x = l_x;
        this.y = l_y;
        this.w = l_w;
        this.h = l_h;
        this.type = l_type;
        this.clicked = false;
        
        this.m_drawButton = function m_drawButton(l_ctx)
        {
            l_ctx.font = "15px Times New Roman"
            l_ctx.fillStyle = "#7FFF00"
            l_ctx.fillRect(this.x,this.y,this.w,this.h)
            l_ctx.fillStyle ="black"
            if(this.type == "START")
            {l_ctx.fillText(this.type,this.x+this.w/3+5,this.y+this.h/2+5)}
            if(this.type == "INSTRUCTION")
            {l_ctx.fillText(this.type,this.x+this.w/4,this.y+this.h/2+5)}
            if(this.type == "BACK")
            {l_ctx.fillText(this.type,this.x+this.w/4-6,this.y+this.h/2+4)}
            if(this.type == "HOME")
            {l_ctx.fillText(this.type,this.x+this.w/4-6,this.y+this.h/2+4)}
        }
    }
    
    function C_MainMenu()
    {
        this.start = new C_Button(420,300,200,30,"START");
        this.instruction = new C_Button(420,350,200,30,"INSTRUCTION");
        this.Restart     = new C_Button(300,10,100,20,"RESTART");
        this.Back        = new C_Button(10,300,100,50,"BACK")
        this.Home        = new C_Button(200,300,100,20,"HOME")
        this.isMainMenuScreen = true;
        
        this.m_drawMainMenu = function m_drawMainMenu(l_ctx)
        {
            if(this.isMainMenuScreen)
            {
                l_ctx.fillStyle = "#DC143C"
                l_ctx.font = "50px Arial"
                l_ctx.fillText("Main Menu",400,200)
            }
        }
    }
    
    function f_draw()
    {
        if(g_home)
        {
            g_context.fillStyle = "Black";
            g_context.fillRect(0,0,g_canvas.width,g_canvas.height);
            g_context.fillStyle = "#0000CD"
            g_context.font = "70px Arial"
            g_context.fillText("Space Invader",300,100);
            g_MainMenu.m_drawMainMenu(g_context);
            g_MainMenu.start.m_drawButton(g_context);
            g_MainMenu.instruction.m_drawButton(g_context)
            
        }
        
        if(g_Inst)
        {
            g_context.fillStyle = "Black";
            g_context.fillRect(0,0,g_canvas.width,g_canvas.height);
            
            f_drawInstructions(g_context);
        }
    }
    
    function f_drawInstructions(l_ctx)
    {
        
        l_ctx.fillStyle = "white"
        l_ctx.font = '20px Arial'
        l_ctx.fillText("1) Destroy the MotherShip ",20,110)
        l_ctx.fillText("2) Destroy all the Aliens before they touch the bunker",20,130)
        l_ctx.fillText("3) Destroying each Alien grants 1 point ",20,150)
        l_ctx.fillText("4) Destroying the mothership grants 5 points",20,170)
        l_ctx.fillText("5) You have only 3 lives ",20,190)
        g_MainMenu.Back.m_drawButton(g_context);
    }
    
    function f_ScoreCount(l_ctx)
    {
        var l_moves = "";
        l_ctx.font = "18px Arial";
        l_ctx.fillStyle = "Red";
        l_moves = "Score: "+g_score;
        l_ctx.fillText(l_moves,20,20)
    }
    
    function f_mouseclick(e)
    {
        g_mouseX = e.clientX;
        g_mouseY = e.clientY;
    }
    
    function f_MainMenuUI()
    {
        if(g_mouseX > g_MainMenu.start.x && g_mouseX < g_MainMenu.start.x+g_MainMenu.start.w)
        {
            if(g_mouseY > g_MainMenu.start.y && g_mouseY < g_MainMenu.start.y+g_MainMenu.start.h)
            {   
                g_GameUI = false;
                g_playgame = true;
                g_home = false;
            }
        }
        
        if(g_mouseX > g_MainMenu.instruction.x && g_mouseX < g_MainMenu.instruction.x+g_MainMenu.instruction.w)
        {
            if(g_mouseY > g_MainMenu.instruction.y && g_mouseY < g_MainMenu.instruction.y+g_MainMenu.instruction.h)
            {   
                g_Inst = true;
                g_home = false;
            }
        }
        
        if(g_mouseX > g_MainMenu.Back.x && g_mouseX < g_MainMenu.Back.x+g_MainMenu.Back.w)
        {
            if(g_mouseY > g_MainMenu.Back.y && g_mouseY < g_MainMenu.Back.y+g_MainMenu.Back.h)
            {
                g_Inst = false;
                g_home = true;
            }
        }
    }
    
    f_AlienObjects();
    g_Spaceship.m_init();
    g_tank.m_init();
    
    g_bunker1.m_initbunker();
    g_bunker2.m_initbunker();
    g_bunker3.m_initbunker();
    g_bunker4.m_initbunker();
    f_initbullet();
    f_Initbkbullets();
    
    function Gameloop()
    {
        if(g_GameUI == 1)
        {
            
            f_draw();
            f_MoveBckg();
            f_MainMenuUI(); 
            
        }
        
        if(g_playgame == 1)
        {
            f_AlienBullets()

            g_Spaceship.m_moveSpaceShip();
            g_tank.m_movetank();
            f_moveAliens();
            f_moveBullet();
            f_tankbullets();
            f_MotherShipBullets();

            f_tankBoundaryCollision();
            g_Spaceship.m_boundarycollision();
            f_CheckBulletBoundaryCollision();
            f_BulletCollisionwithAliens();
            f_BulletCollisionwithSpaceShip();
            f_AlienBoundaryCollision();

            f_AlienBulletBunkerCollision(g_bunker1);
            f_AlienBulletBunkerCollision(g_bunker2);
            f_AlienBulletBunkerCollision(g_bunker3);
            f_AlienBulletBunkerCollision(g_bunker4);
            f_TankBulletBunkerCollision(g_bunker1);
            f_TankBulletBunkerCollision(g_bunker2);
            f_TankBulletBunkerCollision(g_bunker3);
            f_TankBulletBunkerCollision(g_bunker4);
            f_AlienBulletTankCollision();

            f_clearCanvas();

            f_DrawBullets();
            f_drawAlienObjects();
            g_bunker1.m_drawbunker(g_context);
            g_bunker2.m_drawbunker(g_context);
            g_bunker3.m_drawbunker(g_context);
            g_bunker4.m_drawbunker(g_context);
            g_Spaceship.m_drawGrid(g_context);
            g_tank.m_drawGrid(g_context);
            
            f_ScoreCount(g_context);
        }
    }
    
    setInterval(Gameloop,g_TimeInterval);
    
    document.addEventListener("keydown",f_KeyDownEventHandler);
    
    document.addEventListener("keyup",f_KeyUpEventHandler);    

    document.addEventListener("mousedown",f_mouseclick);
    
    
    
    
    
    
    
    
    
    
</script>
</html>